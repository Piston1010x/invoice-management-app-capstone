<!-- templates/admin/dashboard.html -->
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Dashboard</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
        rel="stylesheet">

  <style>
    .stat-card { min-width: 180px; }
  </style>
</head>
<body class="p-4">
<!-- top nav -->
<div th:replace="fragments/navbar :: body"></div>

<h1 class="mb-4">Dashboard</h1>

<!-- =====================  KPI CARDS  ===================== -->
<div class="d-flex flex-wrap gap-3 mb-5">

  <!-- total invoices -->
  <div class="card stat-card shadow-sm flex-fill">
    <div class="card-body text-center">
      <div class="fs-1" th:text="${stats.totalInvoices}">0</div>
      <div class="text-muted">Total&nbsp;Invoices</div>
    </div>
  </div>

  <!-- paid -->
  <div class="card stat-card shadow-sm flex-fill">
    <div class="card-body text-center">
      <div class="fs-1 text-success" th:text="${stats.paid}">0</div>
      <div class="text-muted">Paid</div>
    </div>
  </div>

  <!-- sent -->
  <div class="card stat-card shadow-sm flex-fill">
    <div class="card-body text-center">
      <div class="fs-1 text-primary" th:text="${stats.sent}">0</div>
      <div class="text-muted">Pending</div>
    </div>
  </div>

  <!-- overdue -->
  <div class="card stat-card shadow-sm flex-fill">
    <div class="card-body text-center">
      <div class="fs-1 text-warning" th:text="${stats.overdue}">0</div>
      <div class="text-muted">Overdue</div>
    </div>
  </div>
</div>

<!-- =====================  MONEY CARDS  ================== -->
<div class="row g-3 mb-5">
  <div class="col-md-4">
    <div class="card shadow-sm h-100">
      <div class="card-body text-center">
        <h6 class="text-muted mb-2">Revenue&nbsp;(paid)</h6>
        <div class="fs-3 fw-bold text-success"
             th:text="'$ ' + ${#numbers.formatDecimal(stats.revenue,1,'COMMA',2,'POINT')}">0
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-4">
    <div class="card shadow-sm h-100">
      <div class="card-body text-center">
        <h6 class="text-muted mb-2">Outstanding</h6>
        <div class="fs-3 fw-bold text-danger"
             th:text="'$ ' + ${#numbers.formatDecimal(stats.outstanding,1,'COMMA',2,'POINT')}">0
        </div>
      </div>
    </div>
  </div>
</div>

<!-- =====================  BAR CHART  ==================== -->
<!-- ==== BAR CHART =================================================== -->
<div class="chart-wrapper" style="max-width: 320px; height: 240px">
  <canvas id="invChart"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>

<!-- tell Thymeleaf weâ€™re writing JS so it can inline variables -->
<script th:inline="javascript">
  /*<![CDATA[*/
  const ctx = document.getElementById('invChart');

  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: ['Draft', 'Sent', 'Overdue', 'Paid'],
      datasets: [{
        data: [
          /*[[${stats.draft}]]*/,
          /*[[${stats.sent}]]*/,
          /*[[${stats.overdue}]]*/,
          /*[[${stats.paid}]]*/
        ],
        borderWidth: 1
      }]
    },
    options: {
      plugins: { legend: { display: false } },
      scales : { y: { beginAtZero: true, precision: 0 } }
    }
  });
  /*]]>*/
</script>
</body>
</html>

